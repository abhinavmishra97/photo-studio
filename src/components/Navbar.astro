---
const navItems = [
  { name: "About Us", link: "/about-us" },
  { name: "Gallery", link: "/gallery" },
  {
    name: "Still Photography",
    link: "/still-photography",
    items: [
      { name: "Studio Photography", link: "/still-photography#studio" },
      { name: "Marriage Photography", link: "/still-photography#matrimonial" },
      { name: "Baby Photoshoot", link: "/still-photography#baby" },
      { name: "Product Photo Shoot", link: "/still-photography#product" },
      { name: "Outdoor Photography", link: "/still-photography#outdoor" },
      { name: "Event Photography", link: "/still-photography#event" },
    ],
  },
  {
    name: "Videography",
    link: "/videography",
    items: [
      { name: "Cinematography", link: "/videography#cinematography" },
      { name: "Invitation Videos", link: "/videography#invitation" },
      { name: "Teasers", link: "/videography#teasers" },
      { name: "Drone & LED", link: "/videography#drone" },
    ],
  },
  {
    name: "Printing Solutions",
    link: "/printing-solutions",
    items: [
      { name: "Large Format", link: "/printing-solutions#largeformat" },
      { name: "A0 Scanning", link: "/printing-solutions#scanning" },
      { name: "Cameo Cutting", link: "/printing-solutions#cameo" },
      { name: "Copier Services", link: "/printing-solutions#copier" },
    ],
  },
  {
    name: "Gift Items",
    link: "/gifts-items",
    items: [
      { name: "Sublimation", link: "/gifts-items#sublimation" },
      { name: "Cushions", link: "/gifts-items#cushions" },
      { name: "LED Items", link: "/gifts-items#led" },
      { name: "Magic Cups", link: "/gifts-items#magiccups" },
    ],
  },
  { name: "Contact", link: "/contact" },
];

const path = Astro.url.pathname;
---

<nav
  class="w-full sticky top-0 z-40
    bg-gradient-to-b from-[#FBF7F2] via-[#F5EFE0] to-[#E8D5B5]
    text-[#1a1a1a]
    border-b-2 border-[#E8D5B5]
    shadow-lg transition-all duration-300
    hidden md:block"
>
  <div
    class="max-w-7xl mx-auto flex justify-between items-center px-4 py-0.5 md:px-4"
  >
    <!-- Logo - Left Side -->
    <a
      href="/"
      class="flex items-center hover:scale-105 transition-all duration-300"
    >
      <img 
        src="/rps-favicon.png" 
        alt="Ram Photo Studio" 
        class="h-12 w-auto md:h-14 drop-shadow-md"
      />
    </a>

    <!-- Desktop Menu - Right Side -->
    <ul class="flex items-center space-x-8">
      {navItems.map((item) => {
        const dropdownId = item.name.toLowerCase().replace(/\s+/g, "-");
        
        // Check if current page is active
        const isActive = path.startsWith(item.link) && item.link !== "#";

        return (
          <li class="group relative">
            <div class="flex items-center gap-1">
              <a
                href={item.link}
                class={`text-base font-semibold transition-all duration-300 text-[#1a1a1a] relative inline-block
                hover:scale-110 hover:text-[#8B6F47] hover:drop-shadow-[0_0_8px_rgba(139,111,71,0.6)]
                ${isActive ? "scale-110 text-[#8B6F47]" : ""}
              `}
              >
                {item.name}
                <span
                  class={`absolute bottom-0 left-0 h-0.5 bg-[#8B6F47] transition-all duration-300 ease-out
                  ${isActive ? "w-full animate-pulse" : "w-0 group-hover:w-full"}
                `}
                ></span>
              </a>

              {item.items && (
                <span
                  class={`
                    text-sm ml-1
                    group-hover:rotate-180 group-hover:scale-125 group-hover:text-[#8B6F47]
                    transition-all duration-300
                    ${isActive ? "text-[#8B6F47]" : "text-[#1a1a1a]"}
                  `}
                >
                  â–¼
                </span>
              )}
            </div>

            <!-- Dropdown - Shows on hover -->
            {item.items && (
              <ul
                id={dropdownId}
                class="
                  dropdown absolute left-0 mt-2 w-56
                  bg-gradient-to-b from-[#FBF7F2] to-[#F5EFE0]
                  border-2 border-[#E8D5B5]
                  rounded-lg shadow-2xl py-2
                  opacity-0 invisible group-hover:opacity-100 group-hover:visible
                  translate-y-2 group-hover:translate-y-0 scale-95 group-hover:scale-100
                  transition-all duration-300 z-50
                  overflow-hidden
                "
              >
                {item.items.map((sub) => (
                  <li class="px-2">
                    <a
                      href={sub.link}
                      class="
                        block px-2 py-2.5 rounded
                        text-[#1a1a1a] font-medium
                        hover:bg-[#8B6F47]/20 hover:text-[#8B6F47] hover:pl-4
                        transition-all duration-300
                      "
                    >
                      {sub.name}
                    </a>
                  </li>
                ))}
              </ul>
            )}
          </li>
        );
      })}
    </ul>
  </div>
</nav>

<!-- Mobile Navbar - Always visible on mobile -->
<nav
  class="md:hidden sticky top-0 z-40 bg-gradient-to-b from-[#FBF7F2] via-[#F5EFE0] to-[#E8D5B5] border-b-2 border-[#E8D5B5] shadow-lg"
>
  <div class="flex justify-between items-center px-4 py-2">
    <!-- Studio Logo - Left -->
    <a
      href="/"
      class="flex items-center hover:scale-105 transition-all duration-300"
    >
      <img 
        src="/rps-favicon.png" 
        alt="Ram Photo Studio" 
        class="h-10 w-auto drop-shadow-md"
      />
    </a>

    <!-- Hamburger Button - Right -->
    <button
      id="mobileMenuBtn"
      class="p-2 rounded-lg hover:bg-[#8B6F47]/20 hover:scale-110 transition-all duration-300"
      aria-label="Toggle menu"
    >
      <div class="hamburger w-5 h-4 flex flex-col justify-between">
        <span
          class="hamburger-line block h-[2px] w-full bg-[#1a1a1a] transition-all duration-300"
        ></span>
        <span
          class="hamburger-line block h-[2px] w-full bg-[#1a1a1a] transition-all duration-300"
        ></span>
        <span
          class="hamburger-line block h-[2px] w-full bg-[#1a1a1a] transition-all duration-300"
        ></span>
      </div>
    </button>
  </div>
</nav>

<!-- Mobile Menu -->
<div
  id="mobileMenu"
  class="fixed inset-y-0 right-0 w-3/5 max-w-xs
    translate-x-full
    md:hidden
    bg-[#1F1C19]/95 text-[#EDEAE6]
    backdrop-blur-xl
    px-6 pb-6 pt-4 space-y-2
    border-l border-[#3F3C38]/50
    shadow-2xl transition-transform duration-300
    overflow-y-auto z-50"
  style="backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);"
>
  <!-- Close Button -->
  <div class="flex justify-end mb-4">
    <button
      id="closeMobileMenu"
      class="p-2 rounded-lg hover:bg-[#3F3C38]/50 transition-all duration-300"
      aria-label="Close menu"
    >
      <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
      </svg>
    </button>
  </div>

  {navItems.map((item) =>
    item.items ? (
      <details class="border-b border-[#3F3C38]/50 pb-2">
        <summary class="cursor-pointer py-2 text-base font-medium">
          {item.name}
        </summary>
        <ul class="ml-3 mt-1 space-y-1">
          {item.items.map((sub) => (
            <li>
              <a
                href={sub.link}
                class="mobile-menu-link
                block py-1.5 text-sm
                hover:text-[#D4A373]
                transition
              "
              >
                {sub.name}
              </a>
            </li>
          ))}
        </ul>
      </details>
    ) : (
      <a
        href={item.link}
        class="mobile-menu-link
          block py-2 text-base font-medium border-b border-[#3F3C38]/50
          hover:text-[#D4A373]
          transition
        "
      >
        {item.name}
      </a>
    )
  )}

  <div class="pt-4"></div>
</div>

<!-- Mobile Menu Overlay -->
<div
  id="mobileMenuOverlay"
  class="fixed inset-0 bg-black/50 backdrop-blur-sm opacity-0 invisible transition-all duration-300 z-40 md:hidden"
></div>

<script is:inline>
  const btn = document.getElementById("mobileMenuBtn");
  const mobileMenu = document.getElementById("mobileMenu");
  const overlay = document.getElementById("mobileMenuOverlay");
  const closeBtn = document.getElementById("closeMobileMenu");
  const hamburgerLines = btn.querySelectorAll(".hamburger-line");
  const menuLinks = document.querySelectorAll(".mobile-menu-link");

  function closeMenu() {
    mobileMenu.classList.remove("translate-x-0");
    mobileMenu.classList.add("translate-x-full");
    overlay.classList.remove("opacity-100", "visible");
    overlay.classList.add("opacity-0", "invisible");

    // Animate back to hamburger
    hamburgerLines[0].style.transform =
      "rotate(0) translateY(0) translateX(0)";
    hamburgerLines[1].style.opacity = "1";
    hamburgerLines[2].style.transform =
      "rotate(0) translateY(0) translateX(0)";
  }

  function openMenu() {
    mobileMenu.classList.remove("translate-x-full");
    mobileMenu.classList.add("translate-x-0");
    overlay.classList.remove("opacity-0", "invisible");
    overlay.classList.add("opacity-100", "visible");

    // Animate to cross (X)
    hamburgerLines[0].style.transform =
      "rotate(45deg) translateY(4px) translateX(4px)";
    hamburgerLines[1].style.opacity = "0";
    hamburgerLines[2].style.transform =
      "rotate(-45deg) translateY(-4px) translateX(4px)";
  }

  // Hamburger button click
  btn.addEventListener("click", () => {
    const isOpen = mobileMenu.classList.contains("translate-x-0");
    if (isOpen) {
      closeMenu();
    } else {
      openMenu();
    }
  });

  // Close button click
  closeBtn.addEventListener("click", closeMenu);

  // Overlay click to close
  overlay.addEventListener("click", closeMenu);

  // Close menu when clicking any menu link
  menuLinks.forEach((link) => {
    link.addEventListener("click", closeMenu);
  });
</script>
